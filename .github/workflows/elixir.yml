name: Elixir
on:
  push:
    branches:
      - main
    paths:
      - .github/workflows/publish-image.yml
      - .github/workflows/elixir.yml
      - languages/elixir/**
  schedule:
    - cron:  35 3 * * MON
jobs:
  build:
    strategy:
      matrix:
        version: ["latest", "1.14", "1.13", "1.12", "1.11"]
    name: "${{ matrix.version }}"
    uses: ./.github/workflows/publish-image.yml
    with:
      version: "${{ matrix.version }}"
      language: elixir
      description: Devcontainer for Elixir with ElixirLS
    secrets: inherit
  provenance:
    needs: [build]
    uses: slsa-framework/slsa-github-generator/.github/workflows/generator_container_slsa3.yml@v1.4.0
    with:
      image: "${{ needs.build.outputs.image }}"
      digest: "${{ needs.build.outputs.digest }}"
      registry-username: "${{ secrets.DOCKER_USERNAME }}"
